{"version":3,"file":"attandanceRoutes.js","sourceRoot":"","sources":["../../src/routes/attandanceRoutes.ts"],"names":[],"mappings":";;;;;AAAA,sDAA8B;AAC9B,8EAS6C;AAC7C,kEAAwE;AAExE,MAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAEhC,4BAA4B;AAC5B,kCAAkC;AAClC,MAAM,CAAC,IAAI,CACT,kCAAkC,EAClC,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,QAAQ,CAAC,CAAC,EACrB,qCAAc,CACf,CAAC;AAEF,8BAA8B;AAC9B,MAAM,CAAC,GAAG,CAAC,kCAAkC,EAAE,6BAAY,EAAE,oCAAa,CAAC,CAAC;AAE5E,8BAA8B;AAC9B,MAAM,CAAC,GAAG,CACR,qBAAqB,EACrB,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,iBAAiB,CAAC,CAAC,EACtD,2CAAoB,CACrB,CAAC;AAEF,iCAAiC;AACjC,MAAM,CAAC,GAAG,CACR,2BAA2B,EAC3B,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,iBAAiB,EAAE,QAAQ,CAAC,CAAC,EAChE,gDAAyB,CAC1B,CAAC;AAEF,iCAAiC;AACjC,MAAM,CAAC,GAAG,CACR,6BAA6B,EAC7B,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,iBAAiB,EAAE,UAAU,CAAC,CAAC,EAClE,2CAAoB,CACrB,CAAC;AAEF,2BAA2B;AAC3B,yBAAyB;AACzB,MAAM,CAAC,IAAI,CACT,iBAAiB,EACjB,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC,EACnC,qCAAc,CACf,CAAC;AAEF,4CAA4C;AAC5C,MAAM,CAAC,GAAG,CACR,eAAe,EACf,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC,EACnC,4CAAqB,CACtB,CAAC;AAEF,4DAA4D;AAC5D,MAAM,CAAC,GAAG,CACR,yBAAyB,EACzB,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,aAAa,EAAE,OAAO,EAAE,iBAAiB,CAAC,CAAC,EACtD,iDAA0B,CAC3B,CAAC;AAEF,mEAAmE;AACnE,MAAM,CAAC,GAAG,CACR,uBAAuB,EACvB,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,aAAa,EAAE,OAAO,EAAE,iBAAiB,CAAC,CAAC,EACtD,qDAA8B,CAC/B,CAAC;AAEF,6DAA6D;AAC7D,MAAM,CAAC,GAAG,CACR,eAAe,EACf,6BAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,aAAa,EAAE,OAAO,EAAE,iBAAiB,CAAC,CAAC,EACtD,oCAAa,CACd,CAAC;AAEF,kBAAe,MAAM,CAAC","sourcesContent":["import express from \"express\";\r\nimport {\r\n  markAttendance,\r\n  getAttendance,\r\n  getProjectAttendance,\r\n  getTodayProjectAttendance,\r\n  getAttendanceSummary,\r\n  dailyNormalAttendance,\r\n  getNormalMonthlyAttendance,\r\n  getUserMonthlyAttendanceByType,\r\n} from \"../controllers/attendanceController\";\r\nimport { authenticate, authorize } from \"../middlewares/authMiddleware\";\r\n\r\nconst router = express.Router();\r\n\r\n// PROJECT ATTENDANCE ROUTES\r\n// Driver marks project attendance\r\nrouter.post(\r\n  \"/project/:projectId/user/:userId\",\r\n  authenticate,\r\n  authorize([\"driver\"]),\r\n  markAttendance\r\n);\r\n\r\n// Get user project attendance\r\nrouter.get(\"/project/:projectId/user/:userId\", authenticate, getAttendance);\r\n\r\n// Get project-wide attendance\r\nrouter.get(\r\n  \"/project/:projectId\",\r\n  authenticate,\r\n  authorize([\"admin\", \"super_admin\", \"project_manager\"]),\r\n  getProjectAttendance\r\n);\r\n\r\n// Get today's project attendance\r\nrouter.get(\r\n  \"/project/:projectId/today\",\r\n  authenticate,\r\n  authorize([\"admin\", \"super_admin\", \"project_manager\", \"driver\"]),\r\n  getTodayProjectAttendance\r\n);\r\n\r\n// Get project attendance summary\r\nrouter.get(\r\n  \"/project/:projectId/summary\",\r\n  authenticate,\r\n  authorize([\"admin\", \"super_admin\", \"project_manager\", \"engineer\"]),\r\n  getAttendanceSummary\r\n);\r\n\r\n// NORMAL ATTENDANCE ROUTES\r\n// Mark normal attendance\r\nrouter.post(\r\n  \"/normal/:userId\",\r\n  authenticate,\r\n  authorize([\"super_admin\", \"admin\"]),\r\n  markAttendance\r\n);\r\n\r\n// Get daily normal attendance for all users\r\nrouter.get(\r\n  \"/normal/daily\",\r\n  authenticate,\r\n  authorize([\"super_admin\", \"admin\"]),\r\n  dailyNormalAttendance\r\n);\r\n\r\n// FIXED: Get user's monthly attendance (all types combined)\r\nrouter.get(\r\n  \"/normal/monthly/:userId\",\r\n  authenticate,\r\n  authorize([\"super_admin\", \"admin\", \"project_manager\"]),\r\n  getNormalMonthlyAttendance\r\n);\r\n\r\n// NEW: Get user's monthly attendance by specific type or all types\r\nrouter.get(\r\n  \"/user/:userId/monthly\",\r\n  authenticate,\r\n  authorize([\"super_admin\", \"admin\", \"project_manager\"]),\r\n  getUserMonthlyAttendanceByType\r\n);\r\n\r\n// NEW: Get user's all attendance records (for calendar view)\r\nrouter.get(\r\n  \"/user/:userId\",\r\n  authenticate,\r\n  authorize([\"super_admin\", \"admin\", \"project_manager\"]),\r\n  getAttendance\r\n);\r\n\r\nexport default router;"]}