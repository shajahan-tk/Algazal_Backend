{"version":3,"file":"userRoutes.js","sourceRoot":"","sources":["../../src/routes/userRoutes.ts"],"names":[],"mappings":";;;;;AAAA,sDAA8B;AAC9B,kEAYuC;AACvC,kEAAwE;AACxE,6CAA0C;AAE1C,MAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAEhC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,sBAAK,CAAC,CAAC;AAC7B,qCAAqC;AACrC,MAAM,CAAC,GAAG,CAAC,6BAAY,CAAC,CAAC;AACzB,EAAE;AACF,MAAM,CAAC,GAAG,CACR,YAAY,EACZ,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,CAAC,CAAC,EAC9C,mCAAkB,CACnB,CAAC;AACF,MAAM,CAAC,GAAG,CACR,UAAU,EACV,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,EAAC,UAAU,CAAC,CAAC,EACzD,iCAAgB,CACjB,CAAC;AACF,MAAM,CAAC,GAAG,CACR,UAAU,EACV,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,EAAC,UAAU,CAAC,CAAC,EACzD,iCAAgB,CACjB,CAAC;AAEF,2BAA2B;AAC3B,MAAM,CAAC,IAAI,CACT,GAAG,EACH,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC,EACnC,eAAM,CAAC,MAAM,CAAC;IACZ,EAAE,IAAI,EAAE,cAAc,EAAE,QAAQ,EAAE,CAAC,EAAE;IACrC,EAAE,IAAI,EAAE,gBAAgB,EAAE,QAAQ,EAAE,CAAC,EAAE;IACvC,EAAE,IAAI,EAAE,oBAAoB,EAAE,QAAQ,EAAE,CAAC,EAAE;IAC3C,EAAE,IAAI,EAAE,kBAAkB,EAAE,QAAQ,EAAE,CAAC,EAAE;CAC1C,CAAC,EACF,2BAAU,CACX,CAAC;AAEF,kCAAkC;AAClC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,CAAC,CAAC,EAAE,yBAAQ,CAAC,CAAC;AAC1E,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,6BAAY,EAAE,+BAAc,CAAC,CAAC;AAChD,MAAM,CAAC,GAAG,CACR,aAAa,EACb,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,CAAC,CAAC,EAC9C,iCAAgB,CACjB,CAAC;AACF,kBAAkB;AAClB,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,wBAAO,CAAC,CAAC;AAE5B,cAAc;AACd,MAAM,CAAC,GAAG,CACR,MAAM,EACN,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,CAAC,CAAC,EAC9C,eAAM,CAAC,MAAM,CAAC;IACZ,EAAE,IAAI,EAAE,cAAc,EAAE,QAAQ,EAAE,CAAC,EAAE;IACrC,EAAE,IAAI,EAAE,gBAAgB,EAAE,QAAQ,EAAE,CAAC,EAAE;IACvC,EAAE,IAAI,EAAE,oBAAoB,EAAE,QAAQ,EAAE,CAAC,EAAE;IAC3C,EAAE,IAAI,EAAE,kBAAkB,EAAE,QAAQ,EAAE,CAAC,EAAE;CAC1C,CAAC,EACF,2BAAU,CACX,CAAC;AAEF,2BAA2B;AAC3B,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,IAAA,0BAAS,EAAC,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC,EAAE,2BAAU,CAAC,CAAC;AAEvE,kBAAe,MAAM,CAAC","sourcesContent":["import express from \"express\";\r\nimport {\r\n  createUser,\r\n  getUsers,\r\n  getUser,\r\n  updateUser,\r\n  deleteUser,\r\n  login,\r\n  getActiveEngineers,\r\n  getActiveDrivers,\r\n  getActiveWorkers,\r\n  exportUsersToCSV,\r\n  getCurrentUser,\r\n} from \"../controllers/userController\";\r\nimport { authenticate, authorize } from \"../middlewares/authMiddleware\";\r\nimport { upload } from \"../config/multer\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.post(\"/login\", login);\r\n// Apply authentication to all routes\r\nrouter.use(authenticate);\r\n//\r\nrouter.get(\r\n  \"/engineers\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\"]),\r\n  getActiveEngineers\r\n);\r\nrouter.get(\r\n  \"/drivers\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\",\"engineer\"]),\r\n  getActiveDrivers\r\n);\r\nrouter.get(\r\n  \"/workers\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\",\"engineer\"]),\r\n  getActiveWorkers\r\n);\r\n\r\n// Create user - Admin only\r\nrouter.post(\r\n  \"/\",\r\n  authorize([\"admin\", \"super_admin\"]),\r\n  upload.fields([\r\n    { name: \"profileImage\", maxCount: 1 },\r\n    { name: \"signatureImage\", maxCount: 1 },\r\n    { name: \"emiratesIdDocument\", maxCount: 1 },\r\n    { name: \"passportDocument\", maxCount: 1 },\r\n  ]),\r\n  createUser\r\n);\r\n\r\n// Get all users - Admin + Finance\r\nrouter.get(\"/\", authorize([\"admin\", \"super_admin\", \"finance\"]), getUsers);\r\nrouter.get(\"/me\", authenticate, getCurrentUser);\r\nrouter.get(\r\n  \"/export/csv\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\"]),\r\n  exportUsersToCSV\r\n);\r\n// Get single user\r\nrouter.get(\"/:id\", getUser);\r\n\r\n// Update user\r\nrouter.put(\r\n  \"/:id\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\"]),\r\n  upload.fields([\r\n    { name: \"profileImage\", maxCount: 1 },\r\n    { name: \"signatureImage\", maxCount: 1 },\r\n    { name: \"emiratesIdDocument\", maxCount: 1 },\r\n    { name: \"passportDocument\", maxCount: 1 },\r\n  ]),\r\n  updateUser\r\n);\r\n\r\n// Delete user - Admin only\r\nrouter.delete(\"/:id\", authorize([\"admin\", \"super_admin\"]), deleteUser);\r\n\r\nexport default router;\r\n"]}