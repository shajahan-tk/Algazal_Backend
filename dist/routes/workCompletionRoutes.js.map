{"version":3,"file":"workCompletionRoutes.js","sourceRoot":"","sources":["../../src/routes/workCompletionRoutes.ts"],"names":[],"mappings":";;;;;AAAA,sDAA8B;AAC9B,sFAaiD;AACjD,kEAAwE;AACxE,6CAA0C;AAC1C,gFAAgF;AAEhF,MAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAEhC,MAAM,CAAC,GAAG,CAAC,6BAAY,CAAC,CAAC;AAEzB,MAAM,CAAC,IAAI,CACT,GAAG,EACH,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,+CAAoB,CACrB,CAAC;AAEF,MAAM,CAAC,IAAI,CACT,4BAA4B,EAC5B,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,eAAM,CAAC,KAAK,CAAC,QAAQ,EAAE,EAAE,CAAC,EAC1B,qDAA0B,CAC3B,CAAC;AAEF,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,4CAAiB,CAAC,CAAC;AACrD,MAAM,CAAC,GAAG,CAAC,4BAA4B,EAAE,yDAA8B,CAAC,CAAC;AACzE,MAAM,CAAC,GAAG,CAAC,+BAA+B,EAAE,4CAAiB,CAAC,CAAC;AAC/D,MAAM,CAAC,GAAG,CACR,iCAAiC,EACjC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,2DAAgC,CACjC,CAAC;AAEF,MAAM,CAAC,IAAI,CACT,gCAAgC,EAChC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,+CAAuB,CACxB,CAAC;AACF,0CAA0C;AAC1C,MAAM,CAAC,KAAK,CACV,qCAAqC,EACrC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,oDAAyB,CAC1B,CAAC;AAEF,MAAM,CAAC,GAAG,CACR,6CAA6C,EAC7C,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,eAAM,CAAC,MAAM,CAAC,OAAO,CAAC,EACtB,qDAA0B,CAC3B,CAAC;AACF,8BAA8B;AAC9B,MAAM,CAAC,GAAG,CACR,qCAAqC,EACrC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,+CAAoB,CACrB,CAAC;AAEF,MAAM,CAAC,GAAG,CACR,mCAAmC,EACnC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,6CAAkB,CACnB,CAAC;AAEF,MAAM,CAAC,GAAG,CACR,qCAAqC,EACrC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,+CAAoB,CACrB,CAAC;AAEF,MAAM,CAAC,MAAM,CACX,oCAAoC,EACpC,IAAA,0BAAS,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC,EAC/C,oDAAyB,CAC1B,CAAC;AAEF,kBAAe,MAAM,CAAC","sourcesContent":["import express from \"express\";\r\nimport {\r\n  createWorkCompletion,\r\n  uploadWorkCompletionImages,\r\n  getWorkCompletion,\r\n  deleteWorkCompletionImage,\r\n  getProjectWorkCompletionImages,\r\n  getCompletionData,\r\n  generateCompletionCertificatePdf,\r\n  updateCompletionDate,\r\n  updateHandoverDate,\r\n  updateAcceptanceDate,\r\n  replaceWorkCompletionImage,\r\n  updateWorkCompletionImage,\r\n} from \"../controllers/workCompletionController\";\r\nimport { authenticate, authorize } from \"../middlewares/authMiddleware\";\r\nimport { upload } from \"../config/multer\";\r\nimport {  sendWorkCompletionEmail } from \"../controllers/sendMailPdfController\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.use(authenticate);\r\n\r\nrouter.post(\r\n  \"/\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  createWorkCompletion\r\n);\r\n\r\nrouter.post(\r\n  \"/project/:projectId/images\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  upload.array(\"images\", 10),\r\n  uploadWorkCompletionImages\r\n);\r\n\r\nrouter.get(\"/project/:projectId\", getWorkCompletion);\r\nrouter.get(\"/project/:projectId/images\", getProjectWorkCompletionImages);\r\nrouter.get(\"/project/:projectId/work-comp\", getCompletionData);\r\nrouter.get(\r\n  \"/project/:projectId/certificate\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  generateCompletionCertificatePdf\r\n);\r\n\r\nrouter.post(\r\n  \"/project/:projectId/send-email\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  sendWorkCompletionEmail\r\n);\r\n// Add this route BEFORE the replace route\r\nrouter.patch(\r\n  \"/project/:projectId/images/:imageId\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  updateWorkCompletionImage\r\n);\r\n\r\nrouter.put(\r\n  \"/project/:projectId/images/:imageId/replace\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  upload.single(\"image\"),\r\n  replaceWorkCompletionImage\r\n);\r\n// New routes for date updates\r\nrouter.put(\r\n  \"/project/:projectId/completion-date\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  updateCompletionDate\r\n);\r\n\r\nrouter.put(\r\n  \"/project/:projectId/handover-date\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  updateHandoverDate\r\n);\r\n\r\nrouter.put(\r\n  \"/project/:projectId/acceptance-date\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  updateAcceptanceDate\r\n);\r\n\r\nrouter.delete(\r\n  \"/:workCompletionId/images/:imageId\",\r\n  authorize([\"engineer\", \"admin\", \"super_admin\"]),\r\n  deleteWorkCompletionImage\r\n);\r\n\r\nexport default router;\r\n"]}