{"version":3,"file":"projectRoutes.js","sourceRoot":"","sources":["../../src/routes/projectRoutes.ts"],"names":[],"mappings":"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","sourcesContent":["import express from \"express\";\r\nimport {\r\n  createProject,\r\n  getProjects,\r\n  getProject,\r\n  updateProject,\r\n  updateProjectStatus,\r\n  updateProjectProgress,\r\n  deleteProject,\r\n  assignProject,\r\n  getEngineerProjects,\r\n  getProjectProgressUpdates,\r\n  generateInvoiceData,\r\n  assignTeamAndDriver,\r\n  getAssignedTeam,\r\n  getDriverProjects,\r\n  generateInvoicePdf,\r\n  updateWorkersAndDriver,\r\n  addGrnNumber,\r\n  setWorkStartDate,\r\n  setWorkEndDate,\r\n  getWorkDuration,\r\n} from \"../controllers/projectController\";\r\nimport { authenticate, authorize } from \"../middlewares/authMiddleware\";\r\n\r\nconst router = express.Router();\r\n\r\n// Apply authentication to all routes\r\nrouter.use(authenticate);\r\n\r\n// Create project - Admin/Engineer only\r\nrouter.post(\r\n  \"/\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\"]),\r\n  createProject\r\n);\r\n\r\n// Get all projects\r\nrouter.get(\"/\", getProjects);\r\nrouter.get(\"/engineer\", getEngineerProjects);\r\nrouter.get(\r\n  \"/driver/assigned\",\r\n  authorize([\"driver\", \"admin\", \"super_admin\"]), // Only drivers can access this\r\n  getDriverProjects\r\n);\r\n// Get single project\r\nrouter.get(\"/:id\", getProject);\r\nrouter.get(\r\n  \"/:projectId/invoice\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\", \"engineer\"]),\r\n  generateInvoiceData\r\n);\r\nrouter.get(\r\n  \"/:projectId/invoice/pdf/:selectedBankId\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\", \"engineer\"]),\r\n  generateInvoicePdf\r\n);\r\nrouter.put(\r\n  \"/:projectId/grn-number\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\", \"engineer\"]),\r\n  addGrnNumber\r\n);\r\n// Update project - Admin/Engineer only\r\nrouter.put(\r\n  \"/:id\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\"]),\r\n  updateProject\r\n);\r\nrouter.post(\r\n  \"/:id/assign\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\"]),\r\n  assignProject\r\n);\r\nrouter.get(\r\n  \"/:projectId/team\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\",\"engineer\"]),\r\n  getAssignedTeam\r\n);\r\nrouter.put(\r\n  \"/:id/assign-workers-driver\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\"]),\r\n  updateWorkersAndDriver\r\n);\r\n\r\nrouter.get(\r\n  \"/:projectId/progress\",\r\n  authorize([\"admin\", \"super_admin\", \"finance\",\"engineer\"]),\r\n  getProjectProgressUpdates\r\n);\r\n// Update project status\r\nrouter.patch(\r\n  \"/:id/status\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\", \"finance\"]),\r\n  updateProjectStatus\r\n);\r\n\r\n// Update project progress\r\nrouter.patch(\r\n  \"/:id/progress\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\"]),\r\n  updateProjectProgress\r\n);\r\n\r\n// Delete project - Admin only\r\nrouter.delete(\"/:id\", authorize([\"admin\", \"super_admin\"]), deleteProject);\r\n\r\nrouter.post(\r\n  \"/:projectId/assign-team\",\r\n  authorize([\"admin\", \"super_admin\",\"engineer\"]), // Only admins can assign teams\r\n  assignTeamAndDriver\r\n);\r\nrouter.patch(\r\n  \"/:id/work-start-date\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\"]),\r\n  setWorkStartDate\r\n);\r\n\r\nrouter.patch(\r\n  \"/:id/work-end-date\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\"]),\r\n  setWorkEndDate\r\n);\r\n\r\nrouter.get(\r\n  \"/:id/work-duration\",\r\n  authorize([\"admin\", \"super_admin\", \"engineer\", \"finance\"]),\r\n  getWorkDuration\r\n);\r\nexport default router;\r\n"]}