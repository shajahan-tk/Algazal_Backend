{"version":3,"file":"commentController.js","sourceRoot":"","sources":["../../src/controllers/commentController.ts"],"names":[],"mappings":";;;AACA,yDAAiD;AACjD,kEAAmE;AACnE,wDAAqD;AAExC,QAAA,iBAAiB,GAAG,IAAA,2BAAY,EAC3C,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,EAAE;IACpC,MAAM,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;IACjC,MAAM,EAAE,OAAO,EAAE,GAAG,GAAG,CAAC,IAAI,CAAC;IAC7B,MAAM,MAAM,GAAG,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC;IAEhC,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,MAAM,IAAI,4BAAQ,CAAC,GAAG,EAAE,6BAA6B,CAAC,CAAC;IACzD,CAAC;IAED,MAAM,OAAO,GAAG,MAAM,sBAAO,CAAC,MAAM,CAAC;QACnC,OAAO;QACP,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,SAAS;QAClB,UAAU,EAAE,SAAS;KACtB,CAAC,CAAC;IAEH,MAAM,gBAAgB,GAAG,MAAM,sBAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,QAAQ,CACnE,MAAM,EACN,oBAAoB,CACrB,CAAC;IAEF,GAAG;SACA,MAAM,CAAC,GAAG,CAAC;SACX,IAAI,CACH,IAAI,+BAAW,CAAC,GAAG,EAAE,gBAAgB,EAAE,4BAA4B,CAAC,CACrE,CAAC;AACN,CAAC,CACF,CAAC;AAEW,QAAA,kBAAkB,GAAG,IAAA,2BAAY,EAC5C,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,EAAE;IACpC,MAAM,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;IAEjC,MAAM,UAAU,GAAG,MAAM,sBAAO,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,SAAS,EAAE,CAAC;SAC1D,QAAQ,CAAC,MAAM,EAAE,iCAAiC,CAAC;SACnD,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAE3B,GAAG;SACA,MAAM,CAAC,GAAG,CAAC;SACX,IAAI,CACH,IAAI,+BAAW,CACb,GAAG,EACH,UAAU,EACV,yCAAyC,CAC1C,CACF,CAAC;AACN,CAAC,CACF,CAAC","sourcesContent":["import { Request, Response } from \"express\";\r\nimport { Comment } from \"../models/commentModel\";\r\nimport { ApiError, ApiResponse } from \"../utils/apiHandlerHelpers\";\r\nimport { asyncHandler } from \"../utils/asyncHandler\";\r\n\r\nexport const addProjectComment = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { projectId } = req.params;\r\n    const { content } = req.body;\r\n    const userId = req.user?.userId;\r\n\r\n    if (!content) {\r\n      throw new ApiError(400, \"Comment content is required\");\r\n    }\r\n\r\n    const comment = await Comment.create({\r\n      content,\r\n      user: userId,\r\n      project: projectId,\r\n      actionType: \"general\",\r\n    });\r\n\r\n    const populatedComment = await Comment.findById(comment._id).populate(\r\n      \"user\",\r\n      \"firstName lastName\"\r\n    );\r\n\r\n    res\r\n      .status(201)\r\n      .json(\r\n        new ApiResponse(201, populatedComment, \"Comment added successfully\")\r\n      );\r\n  }\r\n);\r\n\r\nexport const getProjectActivity = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { projectId } = req.params;\r\n\r\n    const activities = await Comment.find({ project: projectId })\r\n      .populate(\"user\", \"firstName lastName profileImage\")\r\n      .sort({ createdAt: -1 });\r\n\r\n    res\r\n      .status(200)\r\n      .json(\r\n        new ApiResponse(\r\n          200,\r\n          activities,\r\n          \"Project activity retrieved successfully\"\r\n        )\r\n      );\r\n  }\r\n);\r\n"]}