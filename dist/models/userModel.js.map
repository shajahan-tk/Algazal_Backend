{"version":3,"file":"userModel.js","sourceRoot":"","sources":["../../src/models/userModel.ts"],"names":[],"mappings":"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","sourcesContent":["import { Document, Schema, model, Types } from \"mongoose\";\r\n\r\nexport interface IUser extends Document {\r\n  _id: Types.ObjectId;\r\n  email: string;\r\n  password: string;\r\n  phoneNumbers?: string[];\r\n  firstName: string;\r\n  lastName: string;\r\n  role: string;\r\n  salary?: number;\r\n  isActive?: boolean;\r\n  profileImage?: string;\r\n  signatureImage?: string;\r\n  address?: string;\r\n  accountNumber?: string;\r\n  emiratesId?: string;\r\n  emiratesIdDocument?: string;\r\n  passportNumber?: string;\r\n  passportDocument?: string;\r\n  iBANNumber?: string;\r\n  createdBy?: Types.ObjectId;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nconst userSchema = new Schema<IUser>(\r\n  {\r\n    email: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n      lowercase: true,\r\n    },\r\n    password: {\r\n      type: String,\r\n      required: true,\r\n      select: false,\r\n    },\r\n    phoneNumbers: {\r\n      type: [String],\r\n      required: false,\r\n      default: [],\r\n    },\r\n    firstName: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n    lastName: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n    role: {\r\n      type: String,\r\n      required: true,\r\n      enum: [\r\n        \"super_admin\",\r\n        \"admin\",\r\n        \"engineer\",\r\n        \"finance\",\r\n        \"driver\",\r\n        \"worker\",\r\n        \"supervisor\",\r\n      ],\r\n      default: \"worker\",\r\n    },\r\n    salary: {\r\n      type: Number,\r\n      required: false,\r\n      min: 0,\r\n      validate: {\r\n        validator: function (this: IUser, value: number) {\r\n          if (value === undefined || value === null) return true;\r\n          return [\"super_admin\", \"admin\"].includes(this.role || \"worker\") || value > 0;\r\n        },\r\n        message: \"Salary must be greater than 0 for this role\",\r\n      },\r\n    },\r\n    isActive: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    profileImage: {\r\n      type: String,\r\n    },\r\n    signatureImage: {\r\n      type: String,\r\n    },\r\n    address: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    accountNumber: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    emiratesId: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    emiratesIdDocument: {\r\n      type: String,\r\n    },\r\n    passportNumber: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    passportDocument: {\r\n      type: String,\r\n    },\r\n    iBANNumber: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    createdBy: {\r\n      type: Schema.Types.ObjectId,\r\n      ref: \"User\",\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n    toJSON: {\r\n      virtuals: true,\r\n      transform: function (doc, ret) {\r\n        delete ret.password;\r\n        delete ret.__v;\r\n        return ret;\r\n      },\r\n    },\r\n    toObject: {\r\n      virtuals: true,\r\n      transform: function (doc, ret) {\r\n        delete ret.password;\r\n        delete ret.__v;\r\n        return ret;\r\n      },\r\n    },\r\n  }\r\n);\r\n\r\n// Indexes for better query performance\r\nuserSchema.index({ email: 1 }, { unique: true });\r\nuserSchema.index({ role: 1 });\r\nuserSchema.index({ isActive: 1 });\r\nuserSchema.index({ firstName: \"text\", lastName: \"text\", email: \"text\" });\r\n\r\nexport const User = model<IUser>(\"User\", userSchema);"]}