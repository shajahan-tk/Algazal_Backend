{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import express, {\r\n  Request,\r\n  Response,\r\n  NextFunction,\r\n  ErrorRequestHandler,\r\n} from \"express\";\r\nimport helmet from \"helmet\";\r\nimport morgan from \"morgan\";\r\nimport cors from \"cors\";\r\nimport dotenv from \"dotenv\";\r\nimport { ApiError } from \"./utils/apiHandlerHelpers\";\r\nimport { errorHandler } from \"./utils/errorHandler\";\r\nimport userRouter from \"./routes/userRoutes\";\r\nimport estimationRouter from \"./routes/estimationRoutes\";\r\nimport clientRouter from \"./routes/clientRoutes\";\r\nimport projectRouter from \"./routes/projectRoutes\";\r\nimport commentRouter from \"./routes/commentRoutes\";\r\nimport quotationRouter from \"./routes/quotationRoutes\";\r\nimport lpoRouter from \"./routes/lpoRoutes\";\r\nimport workCompletionRouter from \"./routes/workCompletionRoutes\";\r\nimport attandanceRouter from \"./routes/attandanceRoutes\";\r\nimport expenseRouter from \"./routes/expenseRoutes\";\r\nimport analyticsRouter from \"./routes/analyticalRoute\";\r\nimport shopRouter from \"./routes/shopRoutes\";\r\nimport vehicleRouter from \"./routes/vehicleRoutes\";\r\nimport billsRouter from \"./routes/billRoutes\";\r\nimport categoryRouter from \"./routes/categoryRoutes\";\r\nimport bankRouter from \"./routes/bankRoutes\";\r\nimport projectProfitRouter from \"./routes/projectProfitRoutes\";\r\nimport employeeExpenseRouter from \"./routes/employeeExpenseRoutes\";\r\nimport payrollRouter from \"./routes/payrollRoutes\";\r\nimport visaRouter from \"./routes/visaExpenseRoutes\";\r\nimport reportTouter from \"./routes/reportRoutes\"\r\nimport employeeSummaryRouter from \"./routes/employeeSummaryRoutes\";\r\nimport attendanceManagementRouter from \"./routes/attendanceManagementRoutes\";\r\nimport bankDetailsRouter from \"./routes/bankDetailsRoutes\";\r\n\r\n\r\nimport { connectDb } from \"./config/db\";\r\nimport { seedSuperAdmin } from \"./utils/seeder\";\r\ndotenv.config();\r\n\r\nconst app = express();\r\n\r\napp.use(\r\n  cors({\r\n    origin: [\"https://new.alghazalgroup.com\",\"https://new.alghazalgroup.com/\",\"http://localhost:5173\",\"http://localhost:5173/\"], // Ensure NO trailing slash\r\n    credentials: true,\r\n    methods: [\"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\", \"OPTIONS\"],\r\n    allowedHeaders: [\r\n      \"Content-Type\",\r\n      \"Authorization\",\r\n      \"Origin\",\r\n      \"X-Requested-With\",\r\n      \"Accept\",\r\n    ],\r\n  })\r\n);\r\n// app.use(limiter);\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\napp.use(morgan(\"common\")); // Logging\r\napp.get(\"/\", (req, res) => {\r\n  console.log(\"Test log route hit\"); // This should appear in console\r\n  res.send(\"Test log\");\r\n});\r\n// app.use(helmet()); // Security\r\napp.get(\"/seed\",(_req:Request,res:Response)=>{\r\n  seedSuperAdmin();\r\n  res.send(\"ok\")\r\n})\r\napp.use(\"/api/user\", userRouter);\r\napp.use(\"/api/estimation\", estimationRouter);\r\napp.use(\"/api/client\", clientRouter);\r\napp.use(\"/api/project\", projectRouter);\r\napp.use(\"/api/comment\", commentRouter);\r\napp.use(\"/api/quotation\", quotationRouter);\r\napp.use(\"/api/lpo\", lpoRouter);\r\napp.use(\"/api/work-completion\", workCompletionRouter);\r\napp.use(\"/api/attendance\", attandanceRouter);\r\napp.use(\"/api/expense\", expenseRouter);\r\napp.use(\"/api/analytics\", analyticsRouter);\r\napp.use(\"/api/shops\", shopRouter);\r\napp.use(\"/api/vehicles\", vehicleRouter);\r\napp.use(\"/api/bills\", billsRouter);\r\napp.use(\"/api/categories\", categoryRouter);\r\napp.use(\"/api/bank\", bankRouter);\r\napp.use(\"/api/bank-details\", bankDetailsRouter);\r\napp.use(\"/api/project-profit\", projectProfitRouter);\r\napp.use(\"/api/employee-expenses\", employeeExpenseRouter);\r\napp.use(\"/api/payroll\", payrollRouter);\r\napp.use(\"/api/visa-expenses\", visaRouter);\r\napp.use(\"/api/reports\", reportTouter);\r\napp.use(\"/api/employee-summary\", employeeSummaryRouter);\r\napp.use(\"/api/attendance-management\", attendanceManagementRouter);\r\napp.use(errorHandler as ErrorRequestHandler);\r\n\r\napp.use((req: Request, res: Response, next: NextFunction) => {\r\n  throw new ApiError(404, \"Route not found\");\r\n});\r\n\r\n// Error-handling middleware\r\n\r\n// app.get(\"*\", (req, res) => {\r\n//   res.sendFile(\"/var/www/kmcc-frontend/dist/index.html\");\r\n// });\r\nconnectDb().then(() => {\r\n  app.listen(4001, () => {\r\n    console.log(`Server is running on port ${process.env.PORT}`);\r\n  });\r\n});\r\n"]}